---
// Interfaz de Propiedades
interface Props {
	booleanBanner: boolean;
}

// API Interna y Componentes
import { getBanner } from '@/lib/api/banner';
import Carousel from '@/components/features/carousel/Carousel';

// Desestructuración con tipado explícito
const { booleanBanner }: Props = Astro.props;

// Obtención del Banner Único
// Nota: La respuesta puede contener múltiples imágenes en un solo objeto banner
const banner = await getBanner();

// Transformación de datos para el Carrusel
// Mapea las imágenes del CMS al formato requerido por CarouselImage
const carouselData = banner.flatMap((item, bannerIndex) =>
	item.banners.map((imgUrl: string, imageIndex: number) => ({
		id: `${item.slug || 'main-banner'}-${bannerIndex}-${imageIndex}`,
		title: 'Banner Principal',
		image: imgUrl,
		url: item.link || 'https://centrojuridicointernacional.co/'
	}))
);
---

{
	carouselData.length > 0 && (
		<div
			class:list={[
				'banner-header-container relative mx-auto w-full max-w-315 overflow-hidden transition-transform duration-300 hover:scale-[1.005]',
				{ hidden: booleanBanner }
			]}
		>
			<div class="mx-auto h-full w-full">
				<Carousel
					width="w-full"
					dotDuration={true}
					autoplaySpeed={5000}
					data={carouselData}
					client:load
					rounded={false}
				/>
			</div>
			<div class="pointer-events-none absolute inset-0 bg-linear-to-r from-black/10 to-transparent opacity-0 transition-opacity duration-300 hover:opacity-100" />
		</div>
	)
}

<style>
	.banner-header-container {
		height: 30vh;
		min-height: 120px;
		object-fit: cover;
	}

	@media (max-width: 768px) {
		.banner-header-container {
			height: auto;
			min-height: 100px;
			object-fit: contain;
		}
	}

	/* Asegurar que las imágenes dentro del carrusel cubran el área */
	.banner-header-container :global(img) {
		height: 100%;
		width: 100%;

		object-position: center;
	}
</style>
