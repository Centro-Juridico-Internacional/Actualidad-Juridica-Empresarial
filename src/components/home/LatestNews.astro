---
// filepath: c:\Users\USUARIO PC\Desktop\ACTUALIDAD\frontend\src\components\home\LatestNews.astro
import { getNews } from '@/lib/get-news';

const { products } = await getNews({ categoryId: '' });
const { currentSlug = null, layout = 'vertical' } = Astro.props; // Recibe el slug actual como prop

// Filtra las noticias para excluir la noticia actual
const latestNews = products.filter((news: any) => news.slug !== currentSlug).slice(0, 3); // Ãšltimas 3 noticias
---

<div
	class={`grid gap-6 ${layout === 'vertical' ? 'grid-cols-1' : 'md:grid-cols-2 lg:grid-cols-3'}`}
>
	{
		latestNews.map((news: any) => (
			<div class="group relative flex w-full items-start gap-4 border-b border-gray-100 pb-6 transition-colors hover:border-green-200">
				<div class="relative h-24 w-24 shrink-0 overflow-hidden rounded-xl">
					<img
						src={news.image}
						alt={news.titulo}
						class="h-full w-full object-cover transition-transform duration-300"
						loading="lazy"
						decoding="async"
					/>
					<div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100" />
				</div>

				<div class="flex flex-1 flex-col">
					<a
						href={`/categorias/${news.categorias[0]}`}
						class="mb-1 inline-block items-center text-xs font-medium text-green-600 transition-colors first-letter:uppercase hover:text-green-700"
					>
						{news.categorias[0]?.trim()}
					</a>

					<h3 class="mb-2 leading-tight font-semibold text-gray-900 decoration-green-500 decoration-2 group-hover:underline">
						<a href={`/noticia/${news.slug}`}>{news.titulo}</a>
					</h3>

					<span class="mt-auto text-xs text-gray-500">{news.dia}</span>
				</div>
			</div>
		))
	}
</div>
