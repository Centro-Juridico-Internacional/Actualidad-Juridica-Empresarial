---
// filepath: c:\Users\USUARIO PC\Desktop\ACTUALIDAD\frontend\src\components\home\NewsCard.astro
import { BlocksRenderer } from '@strapi/blocks-react-renderer';
import YouTubeLite from '@/components/home/global/YouTubeLite';
import { truncateBlocks } from '@/utils/truncateBlocks';

const { product, truncateWords = 30 } = Astro.props;

// Genera el slug del autor
const autorSlug = product.autorName
	? `/autores/${product.autorName.toLowerCase().replace(/\s+/g, '_')}`
	: '#';

// Trunca el contenido
const { blocks, truncated } = truncateBlocks(product.contenido, truncateWords);
---

<article
	class="flex flex-col overflow-hidden rounded-3xl border border-gray-100 bg-white shadow-lg transition-all duration-300 hover:shadow-2xl"
>
	<img src={product.image} alt={`${product.titulo} imagen`} class="h-52 w-full object-cover" />
	<div class="flex flex-1 flex-col p-6">
		<h1 class="mb-2 text-xl font-bold text-gray-900">{product.titulo}</h1>
		<div class="mb-4 text-justify text-sm text-gray-700">
			<BlocksRenderer content={blocks} />
			{
				truncated && (
					<a href={`/noticia/${product.slug}`} class="text-center text-blue-600 hover:underline">
						...click para leer m√°s
					</a>
				)
			}
		</div>
		<div class="mb-4 flex items-center gap-2">
			<span
				class="inline-flex items-center rounded-full bg-blue-100 px-3 py-1 text-center text-xs font-semibold text-blue-800"
			>
				{product.dia} &bull; {product.hora}
			</span>
			{
				product.categorias.map((item: any) => (
					<a
						href={`/categorias/${item}`}
						class="inline-block rounded-full bg-green-100 px-2 py-0.5 text-center text-xs font-medium text-green-700 transition hover:bg-green-200"
					>
						{item}
					</a>
				))
			}
		</div>
		{
			product.UrlYoutube && (
				<div class="mb-4">
					<YouTubeLite videoid={product.UrlYoutube} title={product.titulo} client:load />
				</div>
			)
		}
		<div class="mt-auto flex items-center border-t border-gray-100 pt-4">
			<a href={autorSlug} title={product.autorName}>
				<img src={product.autorAvatar} alt="Autor" class="mr-3 h-8 w-8 rounded-full" />
			</a>
			<a href={autorSlug} class="text-sm text-gray-600 hover:text-green-600 hover:underline">
				{product.autorName}
			</a>
		</div>
	</div>
</article>
