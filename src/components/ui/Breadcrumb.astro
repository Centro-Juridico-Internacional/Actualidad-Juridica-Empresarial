---
// Props
interface Props {
	title?: string;
	className?: string;
}

const { title, className = '' } = Astro.props;
const { pathname } = Astro.url;

// Lógica de desglose de rutas
// Filtra segmentos vacíos derivados del split
const pathSegments = pathname.split('/').filter((segment) => segment);

// Mapeo de nombres de ruta (Traducción amigable)
const routeNames: Record<string, string> = {
	noticia: 'Noticias',
	categorias: 'Categorías',
	autores: 'Autores',
	contacto: 'Contacto',
	buscar: 'Búsqueda'
	// Agregar otras rutas estáticas según necesidad
};

// Generador de items para el breadcrumb
const breadcrumbItems = pathSegments.map((segment, index) => {
	const isLast = index === pathSegments.length - 1;

	// Construcción de URL: / + previos + actual
	const href = `/${pathSegments.slice(0, index + 1).join('/')}`;

	// Determinación del Nombre
	// 1. Si es el último item y hay prop 'title', usarlo.
	// 2. Mapear desde routeNames.
	// 3. Respaldo (Reserva): Capitalizar segmento.
	let name =
		routeNames[segment.toLowerCase()] ||
		segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ');

	if (isLast && title) {
		name = title;
	}

	// Manejo de lógica de rutas redundantes
	// (ej. si estamos en /noticia/[id], el segmento 'noticia' podría no requerir enlace)
	// Por ahora, enlace estándar.

	return {
		name,
		href,
		isLast
	};
});
---

{
	// Solo mostrar si no es el home
	pathname !== '/' && (
		<nav
			aria-label="Breadcrumb"
			class={`mb-4 flex bg-transparent text-xs text-gray-500 md:text-sm ${className}`}
		>
			<ol class="inline-flex items-center space-x-1 md:space-x-2 rtl:space-x-reverse">
				<li class="inline-flex items-center">
					<a
						href="/"
						class="inline-flex items-center font-medium transition-colors hover:text-[#084A00]"
					>
						<svg
							class="me-1 h-3 w-3 md:me-2"
							aria-hidden="true"
							xmlns="http://www.w3.org/2000/svg"
							fill="currentColor"
							viewBox="0 0 20 20"
						>
							<path d="m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z" />
						</svg>
						Inicio
					</a>
				</li>

				{breadcrumbItems.map((item) => (
					<li>
						<div class="flex items-center">
							<svg
								class="mx-1 h-3 w-3 text-gray-400 rtl:rotate-180"
								aria-hidden="true"
								xmlns="http://www.w3.org/2000/svg"
								fill="none"
								viewBox="0 0 6 10"
							>
								<path
									stroke="currentColor"
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="2"
									d="m1 9 4-4-4-4"
								/>
							</svg>

							{item.isLast ? (
								<span class="ms-1 max-w-[150px] truncate font-semibold text-gray-700 sm:max-w-none md:ms-2 dark:text-gray-400">
									{item.name}
								</span>
							) : (
								<a
									href={item.href}
									class="ms-1 font-medium transition-colors hover:text-[#084A00] md:ms-2 dark:text-gray-400 dark:hover:text-white"
								>
									{item.name}
								</a>
							)}
						</div>
					</li>
				))}
			</ol>
		</nav>
	)
}
