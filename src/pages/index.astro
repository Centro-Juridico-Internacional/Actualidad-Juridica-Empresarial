---
// Astro components (layouts)
import Layout from '@/layouts/Layout.astro';

// Astro components (sections)
import ContainerInterviewMagazine from '@/components/sections/home/ContainerInterviewMagazine.astro';
import InformationOfInterest from '@/components/sections/home/InformationOfInterest.astro';
import MoreNews from '@/components/sections/home/MoreNews.astro';
import News from '@/components/sections/home/News.astro';
import Podcast from '@/components/sections/home/Podcast.astro';
import Revista from '@/components/features/revista/Revista';

// Internal API imports
import { getNews } from '@/lib/api/news';
import { getPautas } from '@/lib/api/pautas';
import { getInterviewsUrl } from '@/lib/api/interviews';
import { getCapsulasUrl } from '@/lib/api/capsulas';
import { getPdfs } from '@/lib/api/revista';

// Importar estilos responsive de la revista SOLO para esta p√°gina
import '@/styles/revista-responsive.css';
import UpcomingEvents from '@/components/sections/home/UpcomingEvents.astro';
import Recognitions from '@/components/sections/home/Recognitions.astro';
import SocialMedia from '@/components/sections/home/SocialMedia.astro';
import AlliesCarousel from '@/components/sections/home/AlliesCarousel.astro';

// Fetch all data once at page level to avoid redundant API calls
// Fetch all data in parallel to reduce load time
const [newsData, pautas, interviews, capsulas, pdfs] = await Promise.all([
	getNews({ categoryId: '' }),
	getPautas(),
	getInterviewsUrl(),
	getCapsulasUrl(),
	getPdfs()
]);

const { products } = newsData;

// ISR maneja el cache autom√°ticamente en modo hybrid
---

<Layout title="Inicio" booleanLayout={false}>
	<!-- üîπ Prefetch SOLO del PDF de la revista -->
	<Fragment slot="head">
		<link rel="prefetch" href="/revistas/revista.pdf" />
	</Fragment>

	<News products={products} />
	<InformationOfInterest products={products} />
	<MoreNews products={products} />
	<ContainerInterviewMagazine pautas={pautas} interviews={interviews} />
	<Podcast capsulas={capsulas} />
	<UpcomingEvents />
	<Recognitions />

	{
		pdfs[0]?.pdf && (
			<Revista client:only="react" pdfUrl={pdfs[0].pdf} height={700} className="revista-flipbook" />
		)
	}
	<AlliesCarousel />
	<SocialMedia />
</Layout>
